

<!DOCTYPE html>
<html lang="en">
<head>
  


<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2024数信杯复现 daem0nu</title>


    <meta name="author" content="daem0nu">





  <link rel="alternate" href="/atom.xml " title="daem0nu" type="application/atom+xml">


  
    <link rel="stylesheet" href="/css/main.css">

  

<meta name="generator" content="Hexo 7.0.0"></head>
  <body data-theme="light" class="notransition">
    <script>
      const body = document.body;
      const data = body.getAttribute("data-theme");
      const initTheme = (state) => {
        if (state === "dark") {
          body.setAttribute("data-theme", "dark");
        } else if (state === "light") {
          body.removeAttribute("data-theme");
        } else {
          localStorage.setItem("theme", data);
        }
      };
   
      initTheme(localStorage.getItem("theme"));
      
      setTimeout(() => body.classList.remove("notransition"), 75);
    </script>
  <div class="navbar" role="navigation">
    <nav class="menu">
      <input type="checkbox" id="menu-trigger" class="menu-trigger" />
      <label for="menu-trigger">
        <span class="menu-icon">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 512 512"
          >
            <path
              d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z"
            />
          </svg>
        </span>
      </label>
      <a id="mode">
        <svg
          class="mode-sunny"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 512 512"
        >
          <title>LIGHT</title>
          <line
            x1="256"
            y1="48"
            x2="256"
            y2="96"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="256"
            y1="416"
            x2="256"
            y2="464"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="108.92"
            x2="369.14"
            y2="142.86"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="369.14"
            x2="108.92"
            y2="403.08"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="464"
            y1="256"
            x2="416"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="96"
            y1="256"
            x2="48"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="403.08"
            x2="369.14"
            y2="369.14"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="142.86"
            x2="108.92"
            y2="108.92"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <circle
            cx="256"
            cy="256"
            r="80"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
        </svg>
        <svg
          class="mode-moon"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 512 512"
        >
          <title>DARK</title>
          <line
            x1="256"
            y1="48"
            x2="256"
            y2="96"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="256"
            y1="416"
            x2="256"
            y2="464"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="108.92"
            x2="369.14"
            y2="142.86"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="369.14"
            x2="108.92"
            y2="403.08"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="464"
            y1="256"
            x2="416"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="96"
            y1="256"
            x2="48"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="403.08"
            x2="369.14"
            y2="369.14"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="142.86"
            x2="108.92"
            y2="108.92"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <circle
            cx="256"
            cy="256"
            r="80"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
        </svg>
      </a>
      <div class="trigger">
        <div class="trigger-container">
          
            
            
            
            
            
            
            <a class="menu-link " href="/"> Home</a>
          
            
            
            
            
            
            
            <a class="menu-link " href="/about/"> About</a>
          
            
            
            
            
            
            
            <a class="menu-link " href="/archives/"> Archives</a>
          
            
            
            
            
            
            
            <a class="menu-link " href="/categories/"> Categories</a>
          
            
            
            
            
            
            
            <a class="menu-link " href="/tags/"> Tags</a>
          
        </div>
      </div>
    </nav>
  </div>
  
<div class="wrapper post">
  <main class="page-content" aria-label="Content">
      <header class="header">
        
        <h1 class="header-title" itemprop="headline">2024数信杯复现</h1>
          <div class="post-meta">
            <time>Apr 23, 2024</time>
            <span itemprop="author">
              <span itemprop="name">daem0nu</span>
            </span>
          </div>
        </header>
          
    <div id="toc">
        <strong class="sidebar-title">文章目录</strong>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84U%E7%9B%981"><span class="toc-text">0x01 不安全的U盘1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84U%E7%9B%982"><span class="toc-text">0x02 不安全的U盘2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84U%E7%9B%983"><span class="toc-text">0x03不安全的U盘3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84U%E7%9B%984"><span class="toc-text">0x04 不安全的U盘4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-%E7%BD%91%E7%AB%99%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%9D%E5%AF%B9%E5%AE%89%E5%85%A8-1"><span class="toc-text">0x05 网站的数据绝对安全.1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06-%E7%BD%91%E7%AB%99%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%9D%E5%AF%B9%E5%AE%89%E5%85%A8-2"><span class="toc-text">0x06 网站的数据绝对安全.2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-Magic-audio-%E5%A4%8D%E7%8E%B0"><span class="toc-text">0x07 Magic audio 复现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-drinktea-%E5%A4%8D%E7%8E%B0"><span class="toc-text">0x08 drinktea 复现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x09-rrrrcccc-%E5%A4%8D%E7%8E%B0"><span class="toc-text">0x09 rrrrcccc 复现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0A-easyjava-%E5%A4%8D%E7%8E%B0"><span class="toc-text">0x0A easyjava 复现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0B-bitcoin1-%E5%A4%8D%E7%8E%B0"><span class="toc-text">0x0B bitcoin1 复现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0C-bitcoin2-%E5%A4%8D%E7%8E%B0"><span class="toc-text">0x0C bitcoin2 复现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0D-bitcoin3-%E5%A4%8D%E7%8E%B0"><span class="toc-text">0x0D bitcoin3 复现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0E-bitcoin4-%E5%A4%8D%E7%8E%B0"><span class="toc-text">0x0E bitcoin4 复现</span></a></li></ol>
    </div>

          <div class="page-content"><h2 id="0x01-不安全的U盘1"><a href="#0x01-不安全的U盘1" class="headerlink" title="0x01 不安全的U盘1"></a>0x01 不安全的U盘1</h2><p>工具链接: <a target="_blank" rel="noopener" href="https://www.cnblogs.com/sakura--tears/p/17148293.html">https://www.cnblogs.com/sakura--tears/p/17148293.html</a></p>
<p>先查看文件的镜像<code>vol.py -f WIN-T89OD3C9LOC-20231229-081734.raw imageinfo</code>，后面选择合适的profile</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/U1_imageinfo.png" class="">

<p>执行<code>vol.py -f WIN-T89OD3C9LOC-20231229-081734.raw --profile=Win7SP0x64 hashdump</code>查看hash</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/hash.png" class="">

<p>拿去解密</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/pass.png" class="">

<h2 id="0x02-不安全的U盘2"><a href="#0x02-不安全的U盘2" class="headerlink" title="0x02 不安全的U盘2"></a>0x02 不安全的U盘2</h2><p>执行<code>vol.py -f WIN-T89OD3C9LOC-20231229-081734.raw --profile=Win7SP0x64 netscan</code>查看可疑进程，发现<code>AcroRd32.exe</code>向<code>192.168.31.238:4444</code>创建了连接</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/arch.png" class="">

<p>查找路径<code>vol.py -f WIN-T89OD3C9LOC-20231229-081734.raw --profile=Win7SP0x64 filescan | grep AcroRd32.exe</code></p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/dir.png" class="">

<p>把前面的<code>\Device\HarddisVolumel</code>换成<code>C:\</code>就是答案</p>
<h2 id="0x03不安全的U盘3"><a href="#0x03不安全的U盘3" class="headerlink" title="0x03不安全的U盘3"></a>0x03不安全的U盘3</h2><p>还是执行<code>vol.py -f WIN-T89OD3C9LOC-20231229-081734.raw --profile=Win7SP0x64 netscan</code></p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/arch.png" class="">

<p>可以看到foreign ip : <code>192.168.31.238:4444</code></p>
<h2 id="0x04-不安全的U盘4"><a href="#0x04-不安全的U盘4" class="headerlink" title="0x04 不安全的U盘4"></a>0x04 不安全的U盘4</h2><p>猜测文件是以<code>xml</code>后缀结尾,于是<code>vol.py -f WIN-T89OD3C9LOC-20231229-081734.raw --profile=Win7SP0x64 filescan | grep xml</code></p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/xml.png" class="">

<p>以为是那个keepass.config.xml，dump下来发现没什么用，搜了才知道这是个密码管理工具，应该不是攻击者安装的</p>
<p>然后盲猜一波<code>frp</code>,尝试搜搜<code>toml</code>后缀的文件，结果真找到个可疑的<code>c.toml</code>，执行<code>vol.py -f WIN-T89OD3C9LOC-20231229-081734.raw --profile=Win7SP0x64 filescan | grep toml</code></p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/toml0.png" class="">

<p>执行<code>vol.py -f WIN-T89OD3C9LOC-20231229-081734.raw --profile=Win7SP0x64 dumpfiles -Q 0x000000007e4556a0 -D ./</code>把文件下载到本地</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/toml1.png" class="">

<p>打开看看，果然在内网穿透</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/toml2.png" class="">

<h2 id="0x05-网站的数据绝对安全-1"><a href="#0x05-网站的数据绝对安全-1" class="headerlink" title="0x05 网站的数据绝对安全.1"></a>0x05 网站的数据绝对安全.1</h2><p>先滤出http，发现在对dologin.php登入操作，按时间排序，发现第298个数据包的code标签是2，上面其他的都是1,应该是登入成功了，答案就是livwdaw</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/http.png" class="">


<h2 id="0x06-网站的数据绝对安全-2"><a href="#0x06-网站的数据绝对安全-2" class="headerlink" title="0x06 网站的数据绝对安全.2"></a>0x06 网站的数据绝对安全.2</h2><p>全局搜索key3没有什么结果</p>
<p>尝试导出http对象看看有什么</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/data.png" class="">

<p>在safe.html看到了key3的值</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/key3.jpg" class="">

<h2 id="0x07-Magic-audio-复现"><a href="#0x07-Magic-audio-复现" class="headerlink" title="0x07 Magic audio 复现"></a>0x07 Magic audio 复现</h2><p><code>binwalk -e ctf.wav</code>发现压缩包，但是有密码</p>
<p>后面才知道是sstv编码，参考<a target="_blank" rel="noopener" href="https://ourcodeworld.com/articles/read/956/how-to-convert-decode-a-slow-scan-television-transmissions-sstv-audio-file-to-images-using-qsstv-in-ubuntu-18-04">https://ourcodeworld.com/articles/read/956/how-to-convert-decode-a-slow-scan-television-transmissions-sstv-audio-file-to-images-using-qsstv-in-ubuntu-18-04</a>，解码音频得到</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/wav.png" class="">

<p>最后密码就是菜就多练</p>
<h2 id="0x08-drinktea-复现"><a href="#0x08-drinktea-复现" class="headerlink" title="0x08 drinktea 复现"></a>0x08 drinktea 复现</h2><p>注意到是py的<a href="./out.txt">字节码</a>,参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_37157335/article/details/124121928">python字节码说明</a>，用<code>dis</code>模块一句一句反编译得到源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> c_uint32<br><span class="hljs-keyword">import</span> dis,struct<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span> (v,key):<br>    v0,v1=c_uint32(v[<span class="hljs-number">0</span>]),c_uint32(v[<span class="hljs-number">1</span>])<br>    delta=<span class="hljs-number">555885348</span><br><br>    total=c_uint32(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        v0.value += (((v1.value &lt;&lt; <span class="hljs-number">4</span>) ^ (v1.value &gt;&gt; <span class="hljs-number">5</span>)) + v1.value) ^ (total.value + key[(total.value &amp; <span class="hljs-number">3</span>)])<br>        total.value += delta<br>        v1.value += (((v0.value &lt;&lt; <span class="hljs-number">4</span>) ^ (v0.value &gt;&gt; <span class="hljs-number">5</span>)) + v0.value) ^ (total.value + key[((total.value &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>)])<br>        <span class="hljs-built_in">print</span>(v0.value,v1.value)<br>    <span class="hljs-keyword">return</span> [v0.value,v1.value]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    key = [<span class="hljs-number">1900550021</span>, <span class="hljs-number">2483099539</span>, <span class="hljs-number">2205172504</span>, <span class="hljs-number">1359557939</span>]<br>    arr = [[<span class="hljs-number">392252415</span>, <span class="hljs-number">2941946969</span>], [<span class="hljs-number">1122976151</span>, <span class="hljs-number">1335193774</span>], [<span class="hljs-number">815478816</span>, <span class="hljs-number">2529100980</span>], [<span class="hljs-number">2237049875</span>, <span class="hljs-number">188954780</span>]]<br><br>    flag = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;please input flag: &#x27;</span>)<br>    encry = []<br>    encryted = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(flag),<span class="hljs-number">8</span>):<br>        encry.append(struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>,flag[i:i+<span class="hljs-number">4</span>].encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))[<span class="hljs-number">0</span>])<br>        encry.append(struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>,flag[i+<span class="hljs-number">4</span>:i+<span class="hljs-number">8</span>].encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))[<span class="hljs-number">0</span>])<br>        encrypted = encrypt(encry, key)<br>        encryted.append(encrypted)<br>        encry = []<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span>(encryted)<br>    <span class="hljs-keyword">if</span>(encryted == arr):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;yes~&#x27;</span>);<span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;no~&#x27;</span>);<span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<p><code>arr</code>为<code>flag</code>切片后经过<code>encrypt</code>函数加密得到，这里思路就是直接把<code>encrypt</code>函数反过来写，再解<code>arr</code>列表就能得到flag,最后的脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib,struct<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> c_uint32<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dencrypt</span> (v,key):<br>    v0,v1=c_uint32(v[<span class="hljs-number">0</span>]),c_uint32(v[<span class="hljs-number">1</span>])<br>    delta=<span class="hljs-number">555885348</span><br><br>    total=c_uint32(delta*<span class="hljs-number">32</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        v1.value -= (((v0.value &lt;&lt; <span class="hljs-number">4</span>) ^ (v0.value &gt;&gt; <span class="hljs-number">5</span>)) + v0.value) ^ (total.value + key[((total.value &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>)])<br>        total.value -= delta<br>        v0.value -= (((v1.value &lt;&lt; <span class="hljs-number">4</span>) ^ (v1.value &gt;&gt; <span class="hljs-number">5</span>)) + v1.value) ^ (total.value + key[(total.value &amp; <span class="hljs-number">3</span>)])<br>    <span class="hljs-keyword">return</span> [v0.value,v1.value]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    flag=<span class="hljs-string">&#x27;&#x27;</span><br>    key = [<span class="hljs-number">1900550021</span>, <span class="hljs-number">2483099539</span>, <span class="hljs-number">2205172504</span>, <span class="hljs-number">1359557939</span>]<br>    arr = [[<span class="hljs-number">392252415</span>, <span class="hljs-number">2941946969</span>], [<span class="hljs-number">1122976151</span>, <span class="hljs-number">1335193774</span>], [<span class="hljs-number">815478816</span>, <span class="hljs-number">2529100980</span>], [<span class="hljs-number">2237049875</span>, <span class="hljs-number">188954780</span>]]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        f=dencrypt(arr[i],key)<br>        flag+=struct.pack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>,f[<span class="hljs-number">0</span>]).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)+struct.pack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>,f[<span class="hljs-number">1</span>]).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(flag)    <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<p><code>flag&#123;acb8739759dc496ccc945703037e037f&#125;</code></p>
<h2 id="0x09-rrrrcccc-复现"><a href="#0x09-rrrrcccc-复现" class="headerlink" title="0x09 rrrrcccc 复现"></a>0x09 rrrrcccc 复现</h2><p>先用<a target="_blank" rel="noopener" href="http://www.exeinfo.byethost18.com/?i=1">exeinfo</a>查看文件加壳类型为<code>upx</code>，并且为32位</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/exeinfo.jpg" class="">

<p>尝试upx脱壳，但是出错</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/upx1.png" class="">

<p>随便生成一个tmp.exe，在kali执行<code>upx tmp.exe</code>加壳，拿去010editor对比一下发现，加壳后会增加upx等字段</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/tmpexe.png" class="">

<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/tmpexeupx.png" class="">

<p>再看看main.exe，发现与upx相关的字段都是小写</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/mianexe.png" class="">

<p>尝试把upx都换成大写</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/UpUPX.png" class="">

<p>然后再次尝试脱壳，脱壳成功，好像还可以<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_46287316/article/details/109669066">xdbg手动脱壳</a></p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/unpack.png" class="">

<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/mainnew.png" class="">

<p>绕过debug检测</p>
<p>注意到有异或操作在解密两个函数<code>loc_401485</code>和<code>byte_401301</code></p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/xorfun.png" class="">

<p>计算一下<code>0x401485+0x2FF=0x401784</code>和<code>0x401301+0x14D=0x40144E</code>，分别把这两段地址的hex导出</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/hexdump.png" class="">

<p>用python脚本解密得到原函数的hex</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">loc_401485=[<br>    <span class="hljs-comment">#export hex ...</span><br>]<br><br><span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> loc_401485:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%02X&quot;</span> % (byte^<span class="hljs-number">0x20</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)  <br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <br><br>loc_401301=[<br>    <span class="hljs-comment">#export hex ...</span><br>]<br><span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> loc_401301:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%02X&quot;</span> % (byte^<span class="hljs-number">0x24</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>再用UltraEdit打开脱壳的exe，搜索刚刚导出的hex，并且用py解密的hex替换它们，最后保存</p>
<p>或者直接用ida的script command写byte</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">addr = <span class="hljs-number">0x401485</span><br><span class="hljs-built_in">bytes</span> = [<br>    <span class="hljs-comment">#export hex ...</span><br>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">768</span>):<br>    patch_byte(addr+i, (<span class="hljs-built_in">bytes</span>[i]^<span class="hljs-number">0x20</span>))<br></code></pre></td></tr></table></figure>

<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/replace.png" class="">

<p>再把解密循环nop掉，保存一下idb文件，重新在ida加载idb文件</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/nop.png" class="">

<p>因为自己手动改数据会导致解密函数后，可能会create funtion失败，然后又发现了另一种解密函数的方法，直接调试，在debug的时候读取内存当中的函数</p>
<p>这里也不nop反调试函数当中的exit了，感觉没啥用，直接改寄存器的值。先在反调试函数入口打断点</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/sub_40144F.png" class="">

<p>然后开始debug，执行到这个位置的时候，这个寄存器的值会跟70h去作比较，如果相同则说明程序正在被debug，这里直接右键寄存器，把它的值设置为0，即可绕过</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/70h.png" class="">

<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/set0.jpg" class="">

<p>然后一直F7下一步，遇到printf函数直接ctrl+F7，直到遇到<code>sub_401485</code>函数</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/sub_401485.png" class="">

<p>刚进入<code>sub_401485</code>函数按下F7后会出现这个错误，大概就是说因为汇编指令自己发生了变化，是否需要直接在EIP汇编指令寄存器里面直接创建指令，当然是选yes</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/err.png" class="">

<p>然后在插件栏找到find functions</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/findfunc.jpg" class="">

<p>然后在菜单栏找到functions</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/func.jpg" class="">

<p>然后就可以看我们要的解密之后的函数啦</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/funclist.png" class="">


<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">sub_401485</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> v0; <span class="hljs-comment">// al</span><br>  <span class="hljs-type">char</span> Str1[<span class="hljs-number">48</span>]; <span class="hljs-comment">// [esp+30h] [ebp-308h] BYREF</span><br>  <span class="hljs-type">int</span> v3[<span class="hljs-number">43</span>]; <span class="hljs-comment">// [esp+60h] [ebp-2D8h] BYREF</span><br>  <span class="hljs-type">size_t</span> v4; <span class="hljs-comment">// [esp+10Ch] [ebp-22Ch]</span><br>  <span class="hljs-type">char</span> Str[<span class="hljs-number">256</span>]; <span class="hljs-comment">// [esp+110h] [ebp-228h] BYREF</span><br>  <span class="hljs-type">char</span> v6[<span class="hljs-number">271</span>]; <span class="hljs-comment">// [esp+210h] [ebp-128h] BYREF</span><br>  <span class="hljs-type">char</span> v7; <span class="hljs-comment">// [esp+31Fh] [ebp-19h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> j; <span class="hljs-comment">// [esp+320h] [ebp-18h]</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// [esp+324h] [ebp-14h]</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [esp+328h] [ebp-10h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+32Ch] [ebp-Ch]</span><br>  <span class="hljs-type">char</span> v12[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [esp+330h] [ebp-8h] BYREF</span><br><br>  i = <span class="hljs-number">0</span>;<br>  v10 = <span class="hljs-number">0</span>;<br>  v9 = <span class="hljs-number">0</span>;<br>  j = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">memset</span>(v6, <span class="hljs-number">0</span>, <span class="hljs-number">0x100</span>u);<br>  <span class="hljs-built_in">strcpy</span>(Str, <span class="hljs-string">&quot;debug&quot;</span>);<br>  <span class="hljs-built_in">memset</span>(&amp;Str[<span class="hljs-number">6</span>], <span class="hljs-number">0</span>, <span class="hljs-number">0xFA</span>u);<br>  v0 = <span class="hljs-built_in">strlen</span>(Str);<br>  sub_401301(v6, Str, v0);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">37</span>; ++i )<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot; &quot;</span>);<br>  v4 = <span class="hljs-built_in">strlen</span>(::Str);<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt; v4; ++j )<br>  &#123;<br>    i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>    v10 = ((<span class="hljs-type">unsigned</span> __int8)v12[i - <span class="hljs-number">288</span>] + v10) % <span class="hljs-number">256</span>;<br>    v7 = v12[i - <span class="hljs-number">288</span>];<br>    v12[i - <span class="hljs-number">288</span>] = v12[v10 - <span class="hljs-number">288</span>];<br>    v12[v10 - <span class="hljs-number">288</span>] = v7;<br>    v9 = ((<span class="hljs-type">unsigned</span> __int8)v12[v10 - <span class="hljs-number">288</span>] + (<span class="hljs-type">unsigned</span> __int8)v12[i - <span class="hljs-number">288</span>]) % <span class="hljs-number">256</span>;<br>    ::Str[j] ^= v12[v9 - <span class="hljs-number">288</span>];<span class="hljs-comment">//密钥流和明文异或产生密文</span><br>  &#125;<br>  <span class="hljs-built_in">memcpy</span>(v3, &amp;unk_402000, <span class="hljs-number">0x98</span>u);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">strlen</span>(::Str); ++i )<br>    v12[i - <span class="hljs-number">768</span>] = ::Str[i] ^ v3[i];<span class="hljs-comment">//flag ^ v3 ^ v3= Str ^ v3 = flag</span><br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strcmp</span>(Str1, <span class="hljs-string">&quot;Whatareyourencryption&amp;decryptionbasics&quot;</span>) )<br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\nError: password do not match.\n&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\npassword match.\n&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> *__cdecl <span class="hljs-title function_">sub_401301</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a3)</span><br>&#123;<br>  <span class="hljs-type">int</span> *result; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> v4; <span class="hljs-comment">// [esp+2Fh] [ebp-119h]</span><br>  <span class="hljs-type">char</span> v5[<span class="hljs-number">256</span>]; <span class="hljs-comment">// [esp+30h] [ebp-118h] BYREF</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [esp+138h] [ebp-10h]</span><br>  <span class="hljs-type">int</span> v7[<span class="hljs-number">3</span>]; <span class="hljs-comment">// [esp+13Ch] [ebp-Ch] BYREF</span><br><br>  v6 = <span class="hljs-number">0</span>;<br>  result = (<span class="hljs-type">int</span> *)<span class="hljs-built_in">memset</span>(v5, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(v5));<br>  <span class="hljs-keyword">for</span> ( v7[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; v7[<span class="hljs-number">0</span>] &lt;= <span class="hljs-number">255</span>; ++v7[<span class="hljs-number">0</span>] )<br>  &#123;<br>    *(_BYTE *)(a1 + v7[<span class="hljs-number">0</span>]) = v7[<span class="hljs-number">0</span>];<span class="hljs-comment">//初始化S[]状态向量</span><br>    *((_BYTE *)&amp;v7[<span class="hljs-number">-67</span>] + v7[<span class="hljs-number">0</span>]) = *(_BYTE *)(a2 + v7[<span class="hljs-number">0</span>] % a3);<span class="hljs-comment">//初始化T[]临时向量</span><br>    result = v7;<br>  &#125;<br>  <span class="hljs-keyword">for</span> ( v7[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; v7[<span class="hljs-number">0</span>] &lt;= <span class="hljs-number">255</span>; ++v7[<span class="hljs-number">0</span>] )<span class="hljs-comment">//排列S[]状态向量</span><br>  &#123;<br>    v6 = (*((<span class="hljs-type">char</span> *)&amp;v7[<span class="hljs-number">-67</span>] + v7[<span class="hljs-number">0</span>]) + v6 + *(<span class="hljs-type">unsigned</span> __int8 *)(v7[<span class="hljs-number">0</span>] + a1)) % <span class="hljs-number">256</span>;<br>    v4 = *(_BYTE *)(v7[<span class="hljs-number">0</span>] + a1);<br>    *(_BYTE *)(a1 + v7[<span class="hljs-number">0</span>]) = *(_BYTE *)(v6 + a1);<br>    *(_BYTE *)(a1 + v6) = v4;<br>    result = v7;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>分析得到是<a target="_blank" rel="noopener" href="https://blog.csdn.net/lc_910927/article/details/37599161">rc4加密</a>，猜测<code>v12[i - 768]</code>为<code>Str1</code>，<code>v3[i]</code>是基址为<code>402000</code>的一段数据，而<code>::Str[i]</code>为用户输入，也就是flag，再结合strcmp得到<code>&#39;Whatareyourencryption&amp;decryptionbasics&#39; = flag ^ v3[i]</code>，也就是说<code>&#39;Whatareyourencryption&amp;decryptionbasics&#39; ^ v3[i] = flag ^ v3[i] ^ v3[i] = flag</code>，所以我们需要得到<code>Whatareyourencryption&amp;decryptionbasics</code>经过rc4加密的数据，去ida调试输入<code>Whatareyourencryption&amp;decryptionbasics</code>,存放的地址为<code>00404010-00404208</code>，还有<code>v3[i]</code>的地址段的数据，导出即可</p>
<p>最后解异或</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">v3 = [<br>  <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x00</span>,<br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x37</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x00</span>, <br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span><br>  ]<br><br>v4 = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(v3)):<br>    <span class="hljs-keyword">if</span>(v3[i] != <span class="hljs-number">0x00</span>):<br>        v4.append(v3[i])<br><br>str1 = [<br>  <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x4B</span>, <br>  <span class="hljs-number">0x83</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xA1</span>, <br>  <span class="hljs-number">0x1A</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x0D</span>, <br>  <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x1B</span><br>]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(str1)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%c&quot;</span> % (str1[i]^v4[i]),end=<span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment">#flag&#123;d3db69a34a51d7e1d23d621590827c01&#125;</span><br></code></pre></td></tr></table></figure>



<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/Str.png" class="">

<h2 id="0x0A-easyjava-复现"><a href="#0x0A-easyjava-复现" class="headerlink" title="0x0A easyjava 复现"></a>0x0A easyjava 复现</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ file easyjava.hprof              <br><span class="hljs-comment">#easyjava.hprof: Java HPROF dump, created Thu Apr  6 12:43:25 2023</span><br></code></pre></td></tr></table></figure>

<p>查看<a target="_blank" rel="noopener" href="https://blog.csdn.net/liuhaiabc/article/details/53171434">这里</a>，发现要用MAT分析,mat翻出来gbk后，后面突然找不到了，就换了idea,直接把文件拖进去就行</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/gbk.png" class="">

<blockquote>
<p>想跟你说一个小秘密：我把码表修改成了<br>赵钱孙李周吴郑王冯陈褚卫蒋沈韩杨朱秦尤许何吕施张孔曹严华金魏陶姜戚谢邹喻柏水窦章云苏潘葛奚范彭郎鲁韦昌马苗凤花方俞任袁柳酆鲍史唐费<br>赵钱孙李周吴郑王冯陈褚卫蒋沈韩杨朱秦尤许何吕施张孔曹严华金魏陶姜戚谢邹喻福水窦章云苏潘葛奚范彭郎鲁韦昌马苗凤花方俞任袁柳唐罗史唐费<br>真的旗帜怎么会这么轻易就让你拿到,但你都找到我了那我给你一个密文吧：<br>曹窦韦谢曹方范谢孔许何马沈郑吴喻沈尤苗昌曹喻吴谢卫许朱花沈窦蒋范孔窦吴窦沈昌苗韦孔施朱方曹施秦邹沈窦吴柏孔喻陈鲍</p>
</blockquote>
<p>用python脚本解密得到<code>pCNxpTJxojkPd65zdiQOpz5xbjgSdCcJoC5CdOQNomgTpmhydC5Aoz9Z</code>,尝试base解码但无效，但看别人wp却能解出来，我很异或!?</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python">s = <span class="hljs-string">&quot;赵钱孙李周吴郑王冯陈褚卫蒋沈韩杨朱秦尤许何吕施张孔曹严华金魏陶姜戚谢邹喻柏水窦章云苏潘葛奚范彭郎鲁韦昌马苗凤花方俞任袁柳酆鲍史唐费&quot;</span><br>dic1 = &#123;<span class="hljs-string">&quot;赵&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;钱&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;孙&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;李&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>,<span class="hljs-string">&quot;周&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>,<span class="hljs-string">&quot;吴&quot;</span>: <span class="hljs-string">&quot;5&quot;</span>,<span class="hljs-string">&quot;郑&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;王&quot;</span>: <span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;冯&quot;</span>: <span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;陈&quot;</span>: <span class="hljs-string">&quot;9&quot;</span>,<br>       <span class="hljs-string">&quot;褚&quot;</span>: <span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;卫&quot;</span>: <span class="hljs-string">&quot;b&quot;</span>,<span class="hljs-string">&quot;蒋&quot;</span>: <span class="hljs-string">&quot;c&quot;</span>,<span class="hljs-string">&quot;沈&quot;</span>: <span class="hljs-string">&quot;d&quot;</span>,<span class="hljs-string">&quot;韩&quot;</span>: <span class="hljs-string">&quot;e&quot;</span>,<span class="hljs-string">&quot;杨&quot;</span>: <span class="hljs-string">&quot;f&quot;</span>,<span class="hljs-string">&quot;朱&quot;</span>: <span class="hljs-string">&quot;g&quot;</span>,<span class="hljs-string">&quot;秦&quot;</span>: <span class="hljs-string">&quot;h&quot;</span>,<span class="hljs-string">&quot;尤&quot;</span>: <span class="hljs-string">&quot;i&quot;</span>,<span class="hljs-string">&quot;许&quot;</span>: <span class="hljs-string">&quot;j&quot;</span>,<br>       <span class="hljs-string">&quot;何&quot;</span>: <span class="hljs-string">&quot;k&quot;</span>,<span class="hljs-string">&quot;吕&quot;</span>: <span class="hljs-string">&quot;l&quot;</span>,<span class="hljs-string">&quot;施&quot;</span>: <span class="hljs-string">&quot;m&quot;</span>,<span class="hljs-string">&quot;张&quot;</span>: <span class="hljs-string">&quot;n&quot;</span>,<span class="hljs-string">&quot;孔&quot;</span>: <span class="hljs-string">&quot;o&quot;</span>,<span class="hljs-string">&quot;曹&quot;</span>: <span class="hljs-string">&quot;p&quot;</span>,<span class="hljs-string">&quot;严&quot;</span>: <span class="hljs-string">&quot;q&quot;</span>,<span class="hljs-string">&quot;华&quot;</span>: <span class="hljs-string">&quot;r&quot;</span>,<span class="hljs-string">&quot;金&quot;</span>: <span class="hljs-string">&quot;s&quot;</span>,<span class="hljs-string">&quot;魏&quot;</span>: <span class="hljs-string">&quot;t&quot;</span>,<br>       <span class="hljs-string">&quot;陶&quot;</span>: <span class="hljs-string">&quot;u&quot;</span>,<span class="hljs-string">&quot;姜&quot;</span>: <span class="hljs-string">&quot;v&quot;</span>,<span class="hljs-string">&quot;戚&quot;</span>: <span class="hljs-string">&quot;w&quot;</span>,<span class="hljs-string">&quot;谢&quot;</span>: <span class="hljs-string">&quot;x&quot;</span>,<span class="hljs-string">&quot;邹&quot;</span>: <span class="hljs-string">&quot;y&quot;</span>,<span class="hljs-string">&quot;喻&quot;</span>: <span class="hljs-string">&quot;z&quot;</span>,<span class="hljs-string">&quot;柏&quot;</span>: <span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;水&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>,<span class="hljs-string">&quot;窦&quot;</span>: <span class="hljs-string">&quot;C&quot;</span>,<span class="hljs-string">&quot;章&quot;</span>: <span class="hljs-string">&quot;D&quot;</span>,<br>       <span class="hljs-string">&quot;云&quot;</span>: <span class="hljs-string">&quot;E&quot;</span>,<span class="hljs-string">&quot;苏&quot;</span>: <span class="hljs-string">&quot;F&quot;</span>,<span class="hljs-string">&quot;潘&quot;</span>: <span class="hljs-string">&quot;G&quot;</span>,<span class="hljs-string">&quot;葛&quot;</span>: <span class="hljs-string">&quot;H&quot;</span>,<span class="hljs-string">&quot;奚&quot;</span>: <span class="hljs-string">&quot;I&quot;</span>,<span class="hljs-string">&quot;范&quot;</span>: <span class="hljs-string">&quot;J&quot;</span>,<span class="hljs-string">&quot;彭&quot;</span>: <span class="hljs-string">&quot;K&quot;</span>,<span class="hljs-string">&quot;郎&quot;</span>: <span class="hljs-string">&quot;L&quot;</span>,<span class="hljs-string">&quot;鲁&quot;</span>: <span class="hljs-string">&quot;M&quot;</span>,<span class="hljs-string">&quot;韦&quot;</span>: <span class="hljs-string">&quot;N&quot;</span>,<br>       <span class="hljs-string">&quot;昌&quot;</span>: <span class="hljs-string">&quot;O&quot;</span>,<span class="hljs-string">&quot;马&quot;</span>: <span class="hljs-string">&quot;P&quot;</span>,<span class="hljs-string">&quot;苗&quot;</span>: <span class="hljs-string">&quot;Q&quot;</span>,<span class="hljs-string">&quot;凤&quot;</span>: <span class="hljs-string">&quot;R&quot;</span>,<span class="hljs-string">&quot;花&quot;</span>: <span class="hljs-string">&quot;S&quot;</span>,<span class="hljs-string">&quot;方&quot;</span>: <span class="hljs-string">&quot;T&quot;</span>,<span class="hljs-string">&quot;俞&quot;</span>: <span class="hljs-string">&quot;U&quot;</span>,<span class="hljs-string">&quot;任&quot;</span>: <span class="hljs-string">&quot;V&quot;</span>,<span class="hljs-string">&quot;袁&quot;</span>: <span class="hljs-string">&quot;W&quot;</span>,<span class="hljs-string">&quot;柳&quot;</span>: <span class="hljs-string">&quot;X&quot;</span>,<br>       <span class="hljs-string">&quot;酆&quot;</span>: <span class="hljs-string">&quot;Y&quot;</span>,<span class="hljs-string">&quot;鲍&quot;</span>: <span class="hljs-string">&quot;Z&quot;</span>,<span class="hljs-string">&quot;史&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-string">&quot;唐&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-string">&quot;费&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>&#125;<br><br>secret = <span class="hljs-string">&quot;曹窦韦谢曹方范谢孔许何马沈郑吴喻沈尤苗昌曹喻吴谢卫许朱花沈窦蒋范孔窦吴窦沈昌苗韦孔施朱方曹施秦邹沈窦吴柏孔喻陈鲍&quot;</span><br><br><br>dic2 = &#123;<span class="hljs-string">&quot;赵&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-string">&quot;钱&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-string">&quot;孙&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-string">&quot;李&quot;</span>: <span class="hljs-string">&quot;Z&quot;</span>,<span class="hljs-string">&quot;周&quot;</span>: <span class="hljs-string">&quot;Y&quot;</span>,<span class="hljs-string">&quot;吴&quot;</span>: <span class="hljs-string">&quot;X&quot;</span>,<span class="hljs-string">&quot;郑&quot;</span>: <span class="hljs-string">&quot;W&quot;</span>,<span class="hljs-string">&quot;王&quot;</span>: <span class="hljs-string">&quot;V&quot;</span>,<span class="hljs-string">&quot;冯&quot;</span>: <span class="hljs-string">&quot;U&quot;</span>,<span class="hljs-string">&quot;陈&quot;</span>: <span class="hljs-string">&quot;T&quot;</span>,<br>       <span class="hljs-string">&quot;褚&quot;</span>: <span class="hljs-string">&quot;S&quot;</span>,<span class="hljs-string">&quot;卫&quot;</span>: <span class="hljs-string">&quot;R&quot;</span>,<span class="hljs-string">&quot;蒋&quot;</span>: <span class="hljs-string">&quot;Q&quot;</span>,<span class="hljs-string">&quot;沈&quot;</span>: <span class="hljs-string">&quot;P&quot;</span>,<span class="hljs-string">&quot;韩&quot;</span>: <span class="hljs-string">&quot;O&quot;</span>,<span class="hljs-string">&quot;杨&quot;</span>: <span class="hljs-string">&quot;N&quot;</span>,<span class="hljs-string">&quot;朱&quot;</span>: <span class="hljs-string">&quot;M&quot;</span>,<span class="hljs-string">&quot;秦&quot;</span>: <span class="hljs-string">&quot;L&quot;</span>,<span class="hljs-string">&quot;尤&quot;</span>: <span class="hljs-string">&quot;K&quot;</span>,<span class="hljs-string">&quot;许&quot;</span>: <span class="hljs-string">&quot;J&quot;</span>,<br>       <span class="hljs-string">&quot;何&quot;</span>: <span class="hljs-string">&quot;I&quot;</span>,<span class="hljs-string">&quot;吕&quot;</span>: <span class="hljs-string">&quot;H&quot;</span>,<span class="hljs-string">&quot;施&quot;</span>: <span class="hljs-string">&quot;G&quot;</span>,<span class="hljs-string">&quot;张&quot;</span>: <span class="hljs-string">&quot;F&quot;</span>,<span class="hljs-string">&quot;孔&quot;</span>: <span class="hljs-string">&quot;E&quot;</span>,<span class="hljs-string">&quot;曹&quot;</span>: <span class="hljs-string">&quot;D&quot;</span>,<span class="hljs-string">&quot;严&quot;</span>: <span class="hljs-string">&quot;C&quot;</span>,<span class="hljs-string">&quot;华&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>,<span class="hljs-string">&quot;金&quot;</span>: <span class="hljs-string">&quot;A&quot;</span>,<span class="hljs-string">&quot;魏&quot;</span>: <span class="hljs-string">&quot;z&quot;</span>,<br>       <span class="hljs-string">&quot;陶&quot;</span>: <span class="hljs-string">&quot;y&quot;</span>,<span class="hljs-string">&quot;姜&quot;</span>: <span class="hljs-string">&quot;x&quot;</span>,<span class="hljs-string">&quot;戚&quot;</span>: <span class="hljs-string">&quot;w&quot;</span>,<span class="hljs-string">&quot;谢&quot;</span>: <span class="hljs-string">&quot;v&quot;</span>,<span class="hljs-string">&quot;邹&quot;</span>: <span class="hljs-string">&quot;u&quot;</span>,<span class="hljs-string">&quot;喻&quot;</span>: <span class="hljs-string">&quot;t&quot;</span>,<span class="hljs-string">&quot;柏&quot;</span>: <span class="hljs-string">&quot;s&quot;</span>,<span class="hljs-string">&quot;水&quot;</span>: <span class="hljs-string">&quot;r&quot;</span>,<span class="hljs-string">&quot;窦&quot;</span>: <span class="hljs-string">&quot;q&quot;</span>,<span class="hljs-string">&quot;章&quot;</span>: <span class="hljs-string">&quot;p&quot;</span>,<br>       <span class="hljs-string">&quot;云&quot;</span>: <span class="hljs-string">&quot;o&quot;</span>,<span class="hljs-string">&quot;苏&quot;</span>: <span class="hljs-string">&quot;n&quot;</span>,<span class="hljs-string">&quot;潘&quot;</span>: <span class="hljs-string">&quot;m&quot;</span>,<span class="hljs-string">&quot;葛&quot;</span>: <span class="hljs-string">&quot;l&quot;</span>,<span class="hljs-string">&quot;奚&quot;</span>: <span class="hljs-string">&quot;k&quot;</span>,<span class="hljs-string">&quot;范&quot;</span>: <span class="hljs-string">&quot;j&quot;</span>,<span class="hljs-string">&quot;彭&quot;</span>: <span class="hljs-string">&quot;i&quot;</span>,<span class="hljs-string">&quot;郎&quot;</span>: <span class="hljs-string">&quot;h&quot;</span>,<span class="hljs-string">&quot;鲁&quot;</span>: <span class="hljs-string">&quot;g&quot;</span>,<span class="hljs-string">&quot;韦&quot;</span>: <span class="hljs-string">&quot;f&quot;</span>,<br>       <span class="hljs-string">&quot;昌&quot;</span>: <span class="hljs-string">&quot;e&quot;</span>,<span class="hljs-string">&quot;马&quot;</span>: <span class="hljs-string">&quot;d&quot;</span>,<span class="hljs-string">&quot;苗&quot;</span>: <span class="hljs-string">&quot;c&quot;</span>,<span class="hljs-string">&quot;凤&quot;</span>: <span class="hljs-string">&quot;b&quot;</span>,<span class="hljs-string">&quot;花&quot;</span>: <span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;方&quot;</span>: <span class="hljs-string">&quot;9&quot;</span>,<span class="hljs-string">&quot;俞&quot;</span>: <span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;任&quot;</span>: <span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;袁&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;柳&quot;</span>: <span class="hljs-string">&quot;5&quot;</span>,<br>       <span class="hljs-string">&quot;酆&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>,<span class="hljs-string">&quot;鲍&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>,<span class="hljs-string">&quot;史&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;唐&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;费&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>&#125;<br><br><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> secret:<br>    <span class="hljs-built_in">print</span>(dic1[c],end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="0x0B-bitcoin1-复现"><a href="#0x0B-bitcoin1-复现" class="headerlink" title="0x0B bitcoin1 复现"></a>0x0B bitcoin1 复现</h2><p>搜索<code>ad1文件</code>，<a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/1444898">这里</a>看到似乎要用<code>FTK Imager</code>工具打开</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/mount.jpg" class="">

<p>在download目录下找到了<code>bitcoin</code>的安装程序，输入<code>dir .\bitcoin-22.0-win64-setup.exe /t:a</code>查看访问时间，但是无法获取秒，然后就换用Magnet AXIOM分析，发现bitcoin安装程序最后的访问时间是<strong>2022&#x2F;05&#x2F;09-15:30:41</strong></p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/atime.png" class="">

<h2 id="0x0C-bitcoin2-复现"><a href="#0x0C-bitcoin2-复现" class="headerlink" title="0x0C bitcoin2 复现"></a>0x0C bitcoin2 复现</h2><p>通过<a target="_blank" rel="noopener" href="https://github.com/KingZee/findwallet">findwallet</a></p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/findwallet.png" class="">

<h2 id="0x0D-bitcoin3-复现"><a href="#0x0D-bitcoin3-复现" class="headerlink" title="0x0D bitcoin3 复现"></a>0x0D bitcoin3 复现</h2><p><code>file AppContainerUserCertRead.sys</code>发现是<code>Berkeley DB (Btree, version 9, native byte-order)</code>文件，去搜了一下发现能用<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/37644/examining-berkeley-db-files-from-the-cli">db_dump</a>查看</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/receive.png" class="">

<p>发现两处地址，猜测<code>bc1qf3lta6zr9k4kt9q25sz47vdcnn73zyzk0m5gvz</code>是接收方地址</p>
<h2 id="0x0E-bitcoin4-复现"><a href="#0x0E-bitcoin4-复现" class="headerlink" title="0x0E bitcoin4 复现"></a>0x0E bitcoin4 复现</h2><p>借助gpt勉强把合约看完了，中间看到了很多<strong>transfer</strong>转账的操作，我就很好奇它会不会弄出负数，先看看<code>ERC20</code>的<code>transferFrom</code>先假设<code>sub()</code>函数会处理这个问题，通过gpt还得知<strong>SafeMath</strong>只会处理溢出问题，去搜了一下还真是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">function transferFrom(address from, address to, uint256 value) public returns (bool) &#123;<br>    _balances[from] = _balances[from].sub(value);<br>    _transfer(from, to, value);<br>    emit Approval(from, msg.sender, _allowed[from][msg.sender]);<br>    return true;<br>&#125;<br></code></pre></td></tr></table></figure>

<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/overflow.png" class="">

<p>再去查一下这个<code>sub()</code>，<code>require(b &lt;= a)</code>还是做了负数的判断的，但是这里的是<code>.sub()</code>会不会是另一个方法呢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">function sub(uint256 a, uint256 b) internal pure returns (uint256) &#123;<br>    require(b &lt;= a);<br>    uint256 c = a - b;<br><br>    return c;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>于是我找到了<a target="_blank" rel="noopener" href="https://ethereum.stackexchange.com/questions/128497/where-is-the-single-parameter-version-of-function-sub-defined-in-safemath">这里</a>，大概意思是说如果缺了变量的话，调用sub的object将被作为第一个参数，这样就确实和上面的sub函数一样了，不会发生下溢</p>
<img src="/2024/04/23/2024%E6%95%B0%E4%BF%A1%E6%9D%AF%E5%A4%8D%E7%8E%B0/sub2.png" class="">

<p>再看<strong>CTF</strong>协议的tansferFrom，这里只有协议的拥有者才能执行转账操作，普通用户将无法执行，所以是有点问题的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">function transferFrom(address from, address to, uint256 value) public notFrozen(from) returns (bool) &#123;<br>    require(msg.sender == owner);<br>    return super.transferFrom(from, to, value);<br>&#125;<br></code></pre></td></tr></table></figure></div>
          <nav class="post-nav">
    
    
    <a class="post-nav-item post-nav-next" href="/2024/02/26/2024%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91ezerp%E5%A4%8D%E7%8E%B0/">
      <div class="nav-arrow">OLDER&nbsp;&gt;</div>
      <span class="post-title">2024西湖论剑ezerp复现</span>
    </a>
    
  </nav>

   </main>
</div>


  <footer class="footer">
    <small class="footer_copyright">
      <div id="bottom-inner">
        © 2023 Site by daem0nu
      </div>
    </small>
  </footer>
  
  

    
      <script src="/js/main.js"></script>
    
  
  <script>
    window.FPConfig = {
      delay: 0,
      ignoreKeywords: [],
      maxRPS: 3,
      hoverDelay: 50,
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"></script>

  <!--<div id="totop" style="position:fixed;bottom:150px;right:50px;cursor: pointer;">
    <a title="返回顶部"><img src="../../source/img/totop.png"/></a>
</div>-->

</body>
</html>
